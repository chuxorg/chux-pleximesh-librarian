# LIB-005 — Librarian Read-Path Smoke Tests (Spec ↔ Implementation)

## Status
Active

## Objective

Validate that the **implemented Librarian read API**, the **canonical Mongo schema**, and the **OpenAPI v0 specification** are consistent, deterministic, and demo-safe.

This task ensures there is no drift between:
- stored artifacts
- runtime behavior
- documented contract (OpenAPI)
- Postman-derived interactions

---

## Scope

### In Scope

- Read-path validation only
- Spec ↔ implementation parity checks
- Deterministic behavior verification
- Postman-based smoke testing

### Out of Scope

- Performance benchmarking
- Write-path testing (beyond seed import)
- Authentication / permissions
- UI integration

---

## Test Coverage (Required)

### Artifact Resolution

- `GET /artifacts/{artifact_id}`
  - Returns latest active version
  - Fails if no active version exists
- `GET /artifacts/{artifact_id}?version=vX`
  - Exact match only
  - No fallback behavior

### Typed Aliases

- `GET /tasks/{task_id}`
- `GET /policies/{policy_id}`
- `GET /phases/{phase_id}`

Behavior must match `/artifacts` resolution rules.

---

### Query Semantics

- `kind`, `domain`, `status`, `tag` filters
- Pagination behavior (if present)
- Deterministic ordering

---

### Error Models (Must Match OpenAPI)

- `404` — artifact not found
- `409` — version conflict (if surfaced)
- `422` — malformed request
- `500` — internal error

Responses must match OpenAPI schema exactly.

---

### Integrity Checks

- Checksum verified on every read
- Returned checksum matches stored value
- No silent coercion or normalization

---

## Execution Method

- Use the **Postman project derived from OpenAPI**
- No direct database inspection during tests
- Treat the API as a black box

---

## Acceptance Criteria

LIB-005 is complete when:

1. All required read endpoints respond per OpenAPI
2. OpenAPI examples match live responses
3. Postman collection successfully exercises all read paths
4. No undocumented behavior is observed
5. Results are reproducible across environments

---

## Notes

This task is intentionally narrow and fast.
Its purpose is to establish **confidence**, not coverage.
